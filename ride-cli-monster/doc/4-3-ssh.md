# 免密码登陆和远程拷贝

主要涉及到 ssh key 的生成和部署，以及 scp 命令的使用。

### 生成 ssh key

```
ssh-keygen
```

这样，会在当前用户的用户主目录（ /home/peter ） 下生成一个 .ssh 文件夹

```
cd # 后面不加参数可以回到用户主目录
ls -a # -a 参数可以显示隐藏的文件或者是文件夹
```

会在 ~/.ssh/ 文件夹之下生成一对 ssh key ，包括一个 public key 和一个 private key 。


### 部署 public key 到服务器

现在我们需要做的就是把 public key 拷贝到服务器上的约定位置，这样就可以实现免密码登录了。具体操作步骤是：

首先，用编辑器（ vim 或者 sublime ） 打开 id_rsa.pub 文件，这里看到的一串数也就是所谓的 public key 了。然后，小心拷贝整个字符串（注意末尾不要多拷贝一个回车）到剪切板。

接下来，登录到服务器，到达自己的用户目录（在我的情况下就是 /home/peter），如果这里还没有 .ssh 文件夹（文件夹在 Unix 环境下就是指目录），那就自己创建一下：

```
mkdir .ssh
```

然后跳转到这个文件夹之内：

```
cd .ssh
```

使用 vim 编辑器来创建一个文件

```
vim authorized_keys
```

然后把我 Mac 机器上生成的 id_rsa.pub 中的内容粘贴到这个里面。

Vim 技巧：输入 i ，进入 vim 的插入模式，然后敲鼠标中键（滚轮键），把剪切板中的 public key 粘贴到该文件中。然后，敲 ESC 退出 vim 的插入模式，再敲 ZZ 保存退出。

好，这样，我们开发机器的一个“信物”就在服务器上保存好了，这样就可以实现免密码登录了。来试试吧。

### scp 基于 ssh 的远程 copy

如果有些文件要拷贝到远端服务器上面，可以使用 scp 命令，

```
scp -r project/ ip:
```

注意末尾的 `:` 一定要有。

### 总结

有了 ssh key 来建立客户机和服务器的互信，以后登录和拷贝操作就都不需要密码了。