# 版本控制四步走

版本控制工作的基本内容就是要把每一次的改版内容记录下来，当然相关的操作也有一些，这里总结为四步。

### 第一步：编辑项目

先用编辑器修改一下项目。一般认为当我们要做的一个任务实现了，例如一个小功能实现了，或者一个小 bug 修复了，这样之后，我们就可以把这次的修改内容保存成一个版本了。

### 第二步：查看修改

但是保存版本之前，我们肯定是想要最后看一眼，我们这次都改了哪些内容。这个很有助于避免低级错误的。

图形化客户端中，操作如下。点开这个仓库中，到 `Changes` 一项下面，就可以看到：

![](http://o86bpj665.bkt.clouddn.com/gitbeijing/mac_change.png)


命令行中要查看修改。可以这样，运行

```
git status
```

就可以看到本次的修改内容了。详细的代码还可以通过

```
git diff
```

来查看，但是 git diff 只能显示出那些已经”被跟踪“的文件的修改内容。对于”被跟踪“这个概念，后面会提到。


### 第三步：添加内容


到客户端中，首先图中1和2两处可以看到目前项目修改了什么内容。同时可以看到1处是可以勾选的，也就是如果我一次修改了多个文件，可以只把其中的一部分文件勾选上，添加到下一个版本（ commit  ）之中。更为细致的，你可以到右侧的显示修改内容的区域，选择一部分内容添加到下个版本中。默认行号背景是蓝色的，表示内容被选中了，单击行号，这一行的行号背景就会变成绿色（上图2处所示），这样表示取消了选中状态。单击行号可以取消选中。


那么相同的操作命令行中怎么来作呢？应该说命令行中可以把工作做得更细，但是其实通常是没有必要的。99%的情况下我们的想法是

>不管是添加还是删除文件，都要跟踪，所有修改都添加到下一个版本中去

那么能达成这个要求的操作是

```
git add -A
```

这样就可以了。

### 第四步：制作版本

确定要添加那些修改内容之后，就可以来执行__做版本__的操作了，git 这里的术语叫 commit 。

图形界面中的操作还是看上面的图。3处要填写版本留言（ commit message ） ，先用一行内容说说为啥要做这次修改，下面的大框框里可以写详细的留言，是可选项。最后点击 `Commit to master` （ 把新版本做到 master 分支上 ）按钮，一个版本就保存好了。master 是默认分支的名字，后面讲分支的时候会细聊。

命令行中这样操作。

```
git commit -m"版本留言”
```

注意：命令行中 git commit 之后还可以设置一下参数，比如  -a/-v 这些，来实现更为强大的功能，这个后面开专门的章节介绍吧。

### 总结

所以总结起来，从一个 commit 到下一个 commit，也就是从历史上的一个节点到下一个节点，要经历的操作是下面四步：

![](http://o86bpj665.bkt.clouddn.com/gitbeijing/c2c.png)

重复以上四步，再作一个版本出来。这样到客户端的 `History` 一项下面，就可以看到历史线上已经有两个 commit 了，点开任意一个都可以看到4个 W 。

![](http://o86bpj665.bkt.clouddn.com/gitbeijing/local_4w.png)
